# predictions for the future   SSP5    #
########################################
run_rf_model_prediction_single(mod=mod,
this_item_name=paste("ssp585_predict","_allinput",sep = ''),
clim_dir = dir_resample_mask_ssp5,
ml_raster_dir_this=ml_raster_dir_this)
endTime <- Sys.time()
print(endTime-startTime)
}
########################################
# The Actual Run.                      #
########################################
bug_list <- list("Ger","Rec","Dim","Ind")#,"Lec","Lon","Maz","Mex","Neo","Pro","Rub")
number_replicate <- 10
top_file_dir <- "/Users/liting/Documents/GitHub/r_chagasM/output/rf/pixel_buffer_off" # add an rf layer
species_input_dir <-"/Users/liting/Documents/GitHub/r_chagasM/output/pixel_buffer_off"
input_file_dir <-"/Users/liting/Documents/GitHub/r_chagasM"
clim_dir <- "/Users/liting/Documents/data/resample_mask/historical/"
shapefile_path <-paste(input_file_dir,"/masked_raster/shapefile.shp",sep = '')
for (this_bug in bug_list){
# 1 create all saving path
all_path_stack <- all_ml_saving_paths(top_file_dir,this_bug)
# 2 read all the input bug data
species_input_path <- paste(species_input_dir,"/",this_bug,"/result/kfold_buffer_input_data_",this_bug,".RDS",sep = '')
this_input_data_stack <- readRDS(species_input_path)
# 3 RF run_rf_model_cv
# perform cross-validation
cv_result_list <- run_rf_model_cv(list_x_train_full=this_input_data_stack$list_x_train_full,
list_x_test_full=this_input_data_stack$list_x_test_full,
list_pa_train=this_input_data_stack$list_pa_train,
list_pa_test=this_input_data_stack$list_pa_test,
list_p_train=this_input_data_stack$list_p_train,
list_a_train=this_input_data_stack$list_a_train,
list_p_test=this_input_data_stack$list_p_test,
list_a_test=this_input_data_stack$list_a_test,
ml_evaluate_dir=all_path_stack$ml_evaluate_dir,
number_replicate=number_replicate,
ml_model_dir=all_path_stack$ml_model_dir,
metric_saving=T,
model_saving=T)
# 4 RF run_rf_model_training_all
# train the model (for prediction)
this_model <- run_rf_model_training_all(ml_evaluate_dir=all_path_stack$ml_evaluate_dir,
all_x_full= this_input_data_stack$all_x_full,
all_pa= this_input_data_stack$all_pa,
ml_result_path=all_path_stack$ml_result_path,
dir_sub_name="all_input",
ml_model_dir=all_path_stack$ml_model_dir,
model_saving=T)
# 5 run_rf_model_prediction_basic
dir_resample_mask <- "/Users/liting/Documents/data/resample_mask"
this_model_path <- paste(top_file_dir,'/',this_bug,'/result/model/all_input_final_model_training_all.RDS',sep = '')
# perform predictions on the model trained with all input data
run_rf_model_prediction_basic(mod_path=this_model_path,
clim=clim_dir,
ml_raster_dir=paste(top_file_dir,'/',this_bug,'/result/output_raster',sep = ''),
dir_resample_mask=dir_resample_mask,
dir_sub_name="all_input")
}
library("raster")
bug_list <- list("San","Ger","Rec","Dim","Ind","Lec","Lon","Maz","Mex","Neo","Pro","Rub")
top_maxent_file_dir <- "/Users/liting/Documents/GitHub/r_chagasM/output/pixel_buffer_off"
top_rf_file_dir <- "/Users/liting/Documents/GitHub/r_chagasM/output/rf/pixel_buffer_off"
top_diff_file_dir <- "/Users/liting/Documents/GitHub/r_chagasM/output/figures/final_plot/difference"
for (this_bug in bug_list){
cat("Processing bug: ", this_bug, "\n")
cat("Maxent file path: ", top_maxent_file_dir, "\n")
maxent_result_path_historical <- paste(top_maxent_file_dir,'/',this_bug,'/result/output_raster/all_input/historical_predict_allinput_',this_bug,'.tif',sep = '')
maxent_result_path_ssp126 <- paste(top_maxent_file_dir,'/',this_bug,'/result/output_raster/all_input/ssp126_predict_allinput_',this_bug,'.tif',sep = '')
maxent_result_path_ssp245 <- paste(top_maxent_file_dir,'/',this_bug,'/result/output_raster/all_input/ssp245_predict_allinput_',this_bug,'.tif',sep = '')
maxent_result_path_ssp337 <- paste(top_maxent_file_dir,'/',this_bug,'/result/output_raster/all_input/ssp370_predict_allinput_',this_bug,'.tif',sep = '')
maxent_result_path_ssp585 <- paste(top_maxent_file_dir,'/',this_bug,'/result/output_raster/all_input/ssp585_predict_allinput_',this_bug,'.tif',sep = '')
cat("Maxent result path: ", maxent_result_path_historical, "\n")
rf_result_path_historical <- paste(top_rf_file_dir,'/',this_bug,'/result/output_raster/all_input/historical_predict_allinput_',this_bug,'.tif',sep = '')
rf_result_path_ssp126 <- paste(top_rf_file_dir,'/',this_bug,'/result/output_raster/all_input/ssp126_predict_allinput_',this_bug,'.tif',sep = '')
rf_result_path_ssp245 <- paste(top_rf_file_dir,'/',this_bug,'/result/output_raster/all_input/ssp245_predict_allinput_',this_bug,'.tif',sep = '')
rf_result_path_ssp337 <- paste(top_rf_file_dir,'/',this_bug,'/result/output_raster/all_input/ssp370_predict_allinput_',this_bug,'.tif',sep = '')
rf_result_path_ssp585 <- paste(top_rf_file_dir,'/',this_bug,'/result/output_raster/all_input/ssp585_predict_allinput_',this_bug,'.tif',sep = '')
cat("RF result path: ", rf_result_path_historical, "\n")
maxent_raster_historical <- raster(maxent_result_path_historical)
maxent_raster_ssp126 <- raster(maxent_result_path_ssp126)
maxent_raster_ssp245 <- raster(maxent_result_path_ssp245)
maxent_raster_ssp337 <- raster(maxent_result_path_ssp337)
maxent_raster_ssp585 <- raster(maxent_result_path_ssp585)
cat("Maxent raster loaded: ", maxent_result_path_historical, "\n")
rf_raster_historical <- raster(rf_result_path_historical)
rf_raster_ssp126 <- raster(rf_result_path_ssp126)
rf_raster_ssp245 <- raster(rf_result_path_ssp245)
rf_raster_ssp337 <- raster(rf_result_path_ssp337)
rf_raster_ssp585 <- raster(rf_result_path_ssp585)
cat("RF raster loaded: ", rf_result_path_historical, "\n")
diff_raster_historical <- maxent_raster_historical - rf_raster_historical
diff_raster_ssp126 <- maxent_raster_ssp126 - rf_raster_ssp126
diff_raster_ssp245 <- maxent_raster_ssp245 - rf_raster_ssp245
diff_raster_ssp337 <- maxent_raster_ssp337 - rf_raster_ssp337
diff_raster_ssp585 <- maxent_raster_ssp585 - rf_raster_ssp585
cat("Difference raster calculated: ", "\n")
writeRaster(diff_raster_historical, paste(top_diff_file_dir,'/',this_bug,'/diff_historical.tif',sep = ''), format="GTiff", overwrite=TRUE)
writeRaster(diff_raster_ssp126, paste(top_diff_file_dir,'/',this_bug,'/diff_ssp126.tif',sep = ''), format="GTiff", overwrite=TRUE)
writeRaster(diff_raster_ssp245, paste(top_diff_file_dir,'/',this_bug,'/diff_ssp245.tif',sep = ''), format="GTiff", overwrite=TRUE)
writeRaster(diff_raster_ssp337, paste(top_diff_file_dir,'/',this_bug,'/diff_ssp337.tif',sep = ''), format="GTiff", overwrite=TRUE)
writeRaster(diff_raster_ssp585, paste(top_diff_file_dir,'/',this_bug,'/diff_ssp585.tif',sep = ''), format="GTiff", overwrite=TRUE)
cat("Difference raster saved: ", "\n")
sum_maxent_raster_historical <- cellStats(maxent_raster_historical, sum)
sum_rf_raster_historical <- cellStats(rf_raster_historical, sum)
sum_diff_raster_historical <- cellStats(diff_raster_historical, sum)
cat("Sum calculated: ", "\n")
sum_maxent_raster_ssp126 <- cellStats(maxent_raster_ssp126, sum)
sum_rf_raster_ssp126 <- cellStats(rf_raster_ssp126, sum)
sum_diff_raster_ssp126 <- cellStats(diff_raster_ssp126, sum)
sum_maxent_raster_ssp245 <- cellStats(maxent_raster_ssp245, sum)
sum_rf_raster_ssp245 <- cellStats(rf_raster_ssp245, sum)
sum_diff_raster_ssp245 <- cellStats(diff_raster_ssp245, sum)
sum_maxent_raster_ssp337 <- cellStats(maxent_raster_ssp337, sum)
sum_rf_raster_ssp337 <- cellStats(rf_raster_ssp337, sum)
sum_diff_raster_ssp337 <- cellStats(diff_raster_ssp337, sum)
sum_maxent_raster_ssp585 <- cellStats(maxent_raster_ssp585, sum)
sum_rf_raster_ssp585 <- cellStats(rf_raster_ssp585, sum)
sum_diff_raster_ssp585 <- cellStats(diff_raster_ssp585, sum)
all_sum_results <- list("sum_maxent_raster_historical" = sum_maxent_raster_historical,
"sum_rf_raster_historical" = sum_rf_raster_historical,
"sum_diff_raster_historical" = sum_diff_raster_historical,
"sum_maxent_raster_ssp126" = sum_maxent_raster_ssp126,
"sum_rf_raster_ssp126" = sum_rf_raster_ssp126,
"sum_diff_raster_ssp126" = sum_diff_raster_ssp126,
"sum_maxent_raster_ssp245" = sum_maxent_raster_ssp245,
"sum_rf_raster_ssp245" = sum_rf_raster_ssp245,
"sum_diff_raster_ssp245" = sum_diff_raster_ssp245,
"sum_maxent_raster_ssp337" = sum_maxent_raster_ssp337,
"sum_rf_raster_ssp337" = sum_rf_raster_ssp337,
"sum_diff_raster_ssp337" = sum_diff_raster_ssp337,
"sum_maxent_raster_ssp585" = sum_maxent_raster_ssp585,
"sum_rf_raster_ssp585" = sum_rf_raster_ssp585,
"sum_diff_raster_ssp585" = sum_diff_raster_ssp585)
saveRDS(all_sum_results, paste(top_diff_file_dir,'/',this_bug,'/sum_results.rds',sep = ''))
csv_saving_path_sum <- paste(top_diff_file_dir,'/',this_bug,'/sum_results.csv',sep = '')
write.csv(all_sum_results, file = csv_saving_path_sum)
cat("Sum results saved: ", csv_saving_path_sum, "\n")
}
library("raster")
bug_list <- list("San","Ger","Rec","Dim","Ind","Lec","Lon","Maz","Mex","Neo","Pro","Rub")
top_maxent_file_dir <- "/Users/liting/Documents/GitHub/r_chagasM/output/pixel_buffer_off"
top_rf_file_dir <- "/Users/liting/Documents/GitHub/r_chagasM/output/rf/pixel_buffer_off"
top_diff_file_dir <- "/Users/liting/Documents/GitHub/r_chagasM/output/figures/final_plot/difference"
for (this_bug in bug_list){
cat("Processing bug: ", this_bug, "\n")
cat("Maxent file path: ", top_maxent_file_dir, "\n")
maxent_result_path_historical <- paste(top_maxent_file_dir,'/',this_bug,'/result/output_raster/all_input/historical_predict_allinput_',this_bug,'.tif',sep = '')
maxent_result_path_ssp126 <- paste(top_maxent_file_dir,'/',this_bug,'/result/output_raster/all_input/ssp126_predict_allinput_',this_bug,'.tif',sep = '')
maxent_result_path_ssp245 <- paste(top_maxent_file_dir,'/',this_bug,'/result/output_raster/all_input/ssp245_predict_allinput_',this_bug,'.tif',sep = '')
maxent_result_path_ssp337 <- paste(top_maxent_file_dir,'/',this_bug,'/result/output_raster/all_input/ssp370_predict_allinput_',this_bug,'.tif',sep = '')
maxent_result_path_ssp585 <- paste(top_maxent_file_dir,'/',this_bug,'/result/output_raster/all_input/ssp585_predict_allinput_',this_bug,'.tif',sep = '')
cat("Maxent result path: ", maxent_result_path_historical, "\n")
rf_result_path_historical <- paste(top_rf_file_dir,'/',this_bug,'/result/output_raster/all_input/historical_predict_allinput_',this_bug,'.tif',sep = '')
rf_result_path_ssp126 <- paste(top_rf_file_dir,'/',this_bug,'/result/output_raster/all_input/ssp126_predict_allinput_',this_bug,'.tif',sep = '')
rf_result_path_ssp245 <- paste(top_rf_file_dir,'/',this_bug,'/result/output_raster/all_input/ssp245_predict_allinput_',this_bug,'.tif',sep = '')
rf_result_path_ssp337 <- paste(top_rf_file_dir,'/',this_bug,'/result/output_raster/all_input/ssp370_predict_allinput_',this_bug,'.tif',sep = '')
rf_result_path_ssp585 <- paste(top_rf_file_dir,'/',this_bug,'/result/output_raster/all_input/ssp585_predict_allinput_',this_bug,'.tif',sep = '')
cat("RF result path: ", rf_result_path_historical, "\n")
maxent_raster_historical <- raster(maxent_result_path_historical)
maxent_raster_ssp126 <- raster(maxent_result_path_ssp126)
maxent_raster_ssp245 <- raster(maxent_result_path_ssp245)
maxent_raster_ssp337 <- raster(maxent_result_path_ssp337)
maxent_raster_ssp585 <- raster(maxent_result_path_ssp585)
cat("Maxent raster loaded: ", maxent_result_path_historical, "\n")
rf_raster_historical <- raster(rf_result_path_historical)
rf_raster_ssp126 <- raster(rf_result_path_ssp126)
rf_raster_ssp245 <- raster(rf_result_path_ssp245)
rf_raster_ssp337 <- raster(rf_result_path_ssp337)
rf_raster_ssp585 <- raster(rf_result_path_ssp585)
cat("RF raster loaded: ", rf_result_path_historical, "\n")
startTime <- Sys.time()
diff_raster_historical <- maxent_raster_historical - rf_raster_historical
endTime <- Sys.time()
cat("Difference raster calculated time: ", "\n")
print(endTime-startTime)
diff_raster_ssp126 <- maxent_raster_ssp126 - rf_raster_ssp126
diff_raster_ssp245 <- maxent_raster_ssp245 - rf_raster_ssp245
diff_raster_ssp337 <- maxent_raster_ssp337 - rf_raster_ssp337
diff_raster_ssp585 <- maxent_raster_ssp585 - rf_raster_ssp585
cat("Difference raster calculated: ", "\n")
writeRaster(diff_raster_historical, paste(top_diff_file_dir,'/',this_bug,'/diff_historical.tif',sep = ''), format="GTiff", overwrite=TRUE)
writeRaster(diff_raster_ssp126, paste(top_diff_file_dir,'/',this_bug,'/diff_ssp126.tif',sep = ''), format="GTiff", overwrite=TRUE)
writeRaster(diff_raster_ssp245, paste(top_diff_file_dir,'/',this_bug,'/diff_ssp245.tif',sep = ''), format="GTiff", overwrite=TRUE)
writeRaster(diff_raster_ssp337, paste(top_diff_file_dir,'/',this_bug,'/diff_ssp337.tif',sep = ''), format="GTiff", overwrite=TRUE)
writeRaster(diff_raster_ssp585, paste(top_diff_file_dir,'/',this_bug,'/diff_ssp585.tif',sep = ''), format="GTiff", overwrite=TRUE)
cat("Difference raster saved: ", "\n")
startTime <- Sys.time()
sum_maxent_raster_historical <- cellStats(maxent_raster_historical, sum)
endTime <- Sys.time()
cat("Sum raster calculated time: ", "\n")
print(endTime-startTime)
sum_rf_raster_historical <- cellStats(rf_raster_historical, sum)
sum_diff_raster_historical <- cellStats(diff_raster_historical, sum)
cat("Sum calculated: ", "\n")
sum_maxent_raster_ssp126 <- cellStats(maxent_raster_ssp126, sum)
sum_rf_raster_ssp126 <- cellStats(rf_raster_ssp126, sum)
sum_diff_raster_ssp126 <- cellStats(diff_raster_ssp126, sum)
sum_maxent_raster_ssp245 <- cellStats(maxent_raster_ssp245, sum)
sum_rf_raster_ssp245 <- cellStats(rf_raster_ssp245, sum)
sum_diff_raster_ssp245 <- cellStats(diff_raster_ssp245, sum)
sum_maxent_raster_ssp337 <- cellStats(maxent_raster_ssp337, sum)
sum_rf_raster_ssp337 <- cellStats(rf_raster_ssp337, sum)
sum_diff_raster_ssp337 <- cellStats(diff_raster_ssp337, sum)
sum_maxent_raster_ssp585 <- cellStats(maxent_raster_ssp585, sum)
sum_rf_raster_ssp585 <- cellStats(rf_raster_ssp585, sum)
sum_diff_raster_ssp585 <- cellStats(diff_raster_ssp585, sum)
all_sum_results <- list("sum_maxent_raster_historical" = sum_maxent_raster_historical,
"sum_rf_raster_historical" = sum_rf_raster_historical,
"sum_diff_raster_historical" = sum_diff_raster_historical,
"sum_maxent_raster_ssp126" = sum_maxent_raster_ssp126,
"sum_rf_raster_ssp126" = sum_rf_raster_ssp126,
"sum_diff_raster_ssp126" = sum_diff_raster_ssp126,
"sum_maxent_raster_ssp245" = sum_maxent_raster_ssp245,
"sum_rf_raster_ssp245" = sum_rf_raster_ssp245,
"sum_diff_raster_ssp245" = sum_diff_raster_ssp245,
"sum_maxent_raster_ssp337" = sum_maxent_raster_ssp337,
"sum_rf_raster_ssp337" = sum_rf_raster_ssp337,
"sum_diff_raster_ssp337" = sum_diff_raster_ssp337,
"sum_maxent_raster_ssp585" = sum_maxent_raster_ssp585,
"sum_rf_raster_ssp585" = sum_rf_raster_ssp585,
"sum_diff_raster_ssp585" = sum_diff_raster_ssp585)
saveRDS(all_sum_results, paste(top_diff_file_dir,'/',this_bug,'/sum_results.rds',sep = ''))
csv_saving_path_sum <- paste(top_diff_file_dir,'/',this_bug,'/sum_results.csv',sep = '')
write.csv(all_sum_results, file = csv_saving_path_sum)
cat("Sum results saved: ", csv_saving_path_sum, "\n")
}
library("raster")
bug_list <- list("San","Ger","Rec","Dim","Ind","Lec","Lon","Maz","Mex","Neo","Pro","Rub")
top_maxent_file_dir <- "/Users/liting/Documents/GitHub/r_chagasM/output/pixel_buffer_off"
top_rf_file_dir <- "/Users/liting/Documents/GitHub/r_chagasM/output/rf/pixel_buffer_off"
top_diff_file_dir <- "/Users/liting/Documents/GitHub/r_chagasM/output/figures/final_plot/difference"
for (this_bug in bug_list){
top_file_dir <- paste(top_diff_file_dir,'/',this_bug,sep = '')
print(top_file_dir)
if (!dir.exists(top_file_dir)){
dir.create(top_file_dir)
}else{
print("dir exists")
}
cat("Processing bug: ", this_bug, "\n")
cat("Maxent file path: ", top_maxent_file_dir, "\n")
maxent_result_path_historical <- paste(top_maxent_file_dir,'/',this_bug,'/result/output_raster/all_input/historical_predict_allinput_',this_bug,'.tif',sep = '')
maxent_result_path_ssp126 <- paste(top_maxent_file_dir,'/',this_bug,'/result/output_raster/all_input/ssp126_predict_allinput_',this_bug,'.tif',sep = '')
maxent_result_path_ssp245 <- paste(top_maxent_file_dir,'/',this_bug,'/result/output_raster/all_input/ssp245_predict_allinput_',this_bug,'.tif',sep = '')
maxent_result_path_ssp337 <- paste(top_maxent_file_dir,'/',this_bug,'/result/output_raster/all_input/ssp370_predict_allinput_',this_bug,'.tif',sep = '')
maxent_result_path_ssp585 <- paste(top_maxent_file_dir,'/',this_bug,'/result/output_raster/all_input/ssp585_predict_allinput_',this_bug,'.tif',sep = '')
cat("Maxent result path: ", maxent_result_path_historical, "\n")
rf_result_path_historical <- paste(top_rf_file_dir,'/',this_bug,'/result/output_raster/all_input/historical_predict_allinput_',this_bug,'.tif',sep = '')
rf_result_path_ssp126 <- paste(top_rf_file_dir,'/',this_bug,'/result/output_raster/all_input/ssp126_predict_allinput_',this_bug,'.tif',sep = '')
rf_result_path_ssp245 <- paste(top_rf_file_dir,'/',this_bug,'/result/output_raster/all_input/ssp245_predict_allinput_',this_bug,'.tif',sep = '')
rf_result_path_ssp337 <- paste(top_rf_file_dir,'/',this_bug,'/result/output_raster/all_input/ssp370_predict_allinput_',this_bug,'.tif',sep = '')
rf_result_path_ssp585 <- paste(top_rf_file_dir,'/',this_bug,'/result/output_raster/all_input/ssp585_predict_allinput_',this_bug,'.tif',sep = '')
cat("RF result path: ", rf_result_path_historical, "\n")
maxent_raster_historical <- raster(maxent_result_path_historical)
maxent_raster_ssp126 <- raster(maxent_result_path_ssp126)
maxent_raster_ssp245 <- raster(maxent_result_path_ssp245)
maxent_raster_ssp337 <- raster(maxent_result_path_ssp337)
maxent_raster_ssp585 <- raster(maxent_result_path_ssp585)
cat("Maxent raster loaded: ", maxent_result_path_historical, "\n")
rf_raster_historical <- raster(rf_result_path_historical)
rf_raster_ssp126 <- raster(rf_result_path_ssp126)
rf_raster_ssp245 <- raster(rf_result_path_ssp245)
rf_raster_ssp337 <- raster(rf_result_path_ssp337)
rf_raster_ssp585 <- raster(rf_result_path_ssp585)
cat("RF raster loaded: ", rf_result_path_historical, "\n")
startTime <- Sys.time()
diff_raster_historical <- maxent_raster_historical - rf_raster_historical
endTime <- Sys.time()
cat("Difference raster calculated time: ", "\n")
print(endTime-startTime)
diff_raster_ssp126 <- maxent_raster_ssp126 - rf_raster_ssp126
diff_raster_ssp245 <- maxent_raster_ssp245 - rf_raster_ssp245
diff_raster_ssp337 <- maxent_raster_ssp337 - rf_raster_ssp337
diff_raster_ssp585 <- maxent_raster_ssp585 - rf_raster_ssp585
cat("Difference raster calculated: ", "\n")
writeRaster(diff_raster_historical, paste(top_diff_file_dir,'/',this_bug,'/diff_historical.tif',sep = ''), format="GTiff", overwrite=TRUE)
writeRaster(diff_raster_ssp126, paste(top_diff_file_dir,'/',this_bug,'/diff_ssp126.tif',sep = ''), format="GTiff", overwrite=TRUE)
writeRaster(diff_raster_ssp245, paste(top_diff_file_dir,'/',this_bug,'/diff_ssp245.tif',sep = ''), format="GTiff", overwrite=TRUE)
writeRaster(diff_raster_ssp337, paste(top_diff_file_dir,'/',this_bug,'/diff_ssp337.tif',sep = ''), format="GTiff", overwrite=TRUE)
writeRaster(diff_raster_ssp585, paste(top_diff_file_dir,'/',this_bug,'/diff_ssp585.tif',sep = ''), format="GTiff", overwrite=TRUE)
cat("Difference raster saved: ", "\n")
startTime <- Sys.time()
sum_maxent_raster_historical <- cellStats(maxent_raster_historical, sum)
endTime <- Sys.time()
cat("Sum raster calculated time: ", "\n")
print(endTime-startTime)
sum_rf_raster_historical <- cellStats(rf_raster_historical, sum)
sum_diff_raster_historical <- cellStats(diff_raster_historical, sum)
cat("Sum calculated: ", "\n")
sum_maxent_raster_ssp126 <- cellStats(maxent_raster_ssp126, sum)
sum_rf_raster_ssp126 <- cellStats(rf_raster_ssp126, sum)
sum_diff_raster_ssp126 <- cellStats(diff_raster_ssp126, sum)
sum_maxent_raster_ssp245 <- cellStats(maxent_raster_ssp245, sum)
sum_rf_raster_ssp245 <- cellStats(rf_raster_ssp245, sum)
sum_diff_raster_ssp245 <- cellStats(diff_raster_ssp245, sum)
sum_maxent_raster_ssp337 <- cellStats(maxent_raster_ssp337, sum)
sum_rf_raster_ssp337 <- cellStats(rf_raster_ssp337, sum)
sum_diff_raster_ssp337 <- cellStats(diff_raster_ssp337, sum)
sum_maxent_raster_ssp585 <- cellStats(maxent_raster_ssp585, sum)
sum_rf_raster_ssp585 <- cellStats(rf_raster_ssp585, sum)
sum_diff_raster_ssp585 <- cellStats(diff_raster_ssp585, sum)
all_sum_results <- list("sum_maxent_raster_historical" = sum_maxent_raster_historical,
"sum_rf_raster_historical" = sum_rf_raster_historical,
"sum_diff_raster_historical" = sum_diff_raster_historical,
"sum_maxent_raster_ssp126" = sum_maxent_raster_ssp126,
"sum_rf_raster_ssp126" = sum_rf_raster_ssp126,
"sum_diff_raster_ssp126" = sum_diff_raster_ssp126,
"sum_maxent_raster_ssp245" = sum_maxent_raster_ssp245,
"sum_rf_raster_ssp245" = sum_rf_raster_ssp245,
"sum_diff_raster_ssp245" = sum_diff_raster_ssp245,
"sum_maxent_raster_ssp337" = sum_maxent_raster_ssp337,
"sum_rf_raster_ssp337" = sum_rf_raster_ssp337,
"sum_diff_raster_ssp337" = sum_diff_raster_ssp337,
"sum_maxent_raster_ssp585" = sum_maxent_raster_ssp585,
"sum_rf_raster_ssp585" = sum_rf_raster_ssp585,
"sum_diff_raster_ssp585" = sum_diff_raster_ssp585)
saveRDS(all_sum_results, paste(top_diff_file_dir,'/',this_bug,'/sum_results.rds',sep = ''))
csv_saving_path_sum <- paste(top_diff_file_dir,'/',this_bug,'/sum_results.csv',sep = '')
write.csv(all_sum_results, file = csv_saving_path_sum)
cat("Sum results saved: ", csv_saving_path_sum, "\n")
}
library("raster")
bug_list <- list("San","Ger","Rec","Dim","Ind","Lec","Lon","Maz","Mex","Neo","Pro","Rub")
top_maxent_file_dir <- "/Users/liting/Documents/GitHub/r_chagasM/output/pixel_buffer_off"
top_rf_file_dir <- "/Users/liting/Documents/GitHub/r_chagasM/output/rf/pixel_buffer_off"
top_diff_file_dir <- "/Users/liting/Documents/GitHub/r_chagasM/output/figures/final_plot/difference"
for (this_bug in bug_list){
top_file_dir <- paste(top_diff_file_dir,'/',this_bug,sep = '')
print(top_file_dir)
if (!dir.exists(top_file_dir)){
dir.create(top_file_dir)
}else{
print("dir exists")
}
cat("Processing bug: ", this_bug, "\n")
cat("Maxent file path: ", top_maxent_file_dir, "\n")
maxent_result_path_historical <- paste(top_maxent_file_dir,'/',this_bug,'/result/output_raster/all_input/historical_predict_allinput_',this_bug,'.tif',sep = '')
maxent_result_path_ssp126 <- paste(top_maxent_file_dir,'/',this_bug,'/result/output_raster/all_input/ssp126_predict_allinput_',this_bug,'.tif',sep = '')
maxent_result_path_ssp245 <- paste(top_maxent_file_dir,'/',this_bug,'/result/output_raster/all_input/ssp245_predict_allinput_',this_bug,'.tif',sep = '')
maxent_result_path_ssp370 <- paste(top_maxent_file_dir,'/',this_bug,'/result/output_raster/all_input/ssp370_predict_allinput_',this_bug,'.tif',sep = '')
maxent_result_path_ssp585 <- paste(top_maxent_file_dir,'/',this_bug,'/result/output_raster/all_input/ssp585_predict_allinput_',this_bug,'.tif',sep = '')
cat("Maxent result path: ", maxent_result_path_historical, "\n")
rf_result_path_historical <- paste(top_rf_file_dir,'/',this_bug,'/result/output_raster/all_input/historical_predict_allinput_',this_bug,'.tif',sep = '')
rf_result_path_ssp126 <- paste(top_rf_file_dir,'/',this_bug,'/result/output_raster/all_input/ssp126_predict_allinput_',this_bug,'.tif',sep = '')
rf_result_path_ssp245 <- paste(top_rf_file_dir,'/',this_bug,'/result/output_raster/all_input/ssp245_predict_allinput_',this_bug,'.tif',sep = '')
rf_result_path_ssp370 <- paste(top_rf_file_dir,'/',this_bug,'/result/output_raster/all_input/ssp370_predict_allinput_',this_bug,'.tif',sep = '')
rf_result_path_ssp585 <- paste(top_rf_file_dir,'/',this_bug,'/result/output_raster/all_input/ssp585_predict_allinput_',this_bug,'.tif',sep = '')
cat("RF result path: ", rf_result_path_historical, "\n")
maxent_raster_historical <- raster(maxent_result_path_historical)
maxent_raster_ssp126 <- raster(maxent_result_path_ssp126)
maxent_raster_ssp245 <- raster(maxent_result_path_ssp245)
maxent_raster_ssp370 <- raster(maxent_result_path_ssp370)
maxent_raster_ssp585 <- raster(maxent_result_path_ssp585)
cat("Maxent raster loaded: ", maxent_result_path_historical, "\n")
rf_raster_historical <- raster(rf_result_path_historical)
rf_raster_ssp126 <- raster(rf_result_path_ssp126)
rf_raster_ssp245 <- raster(rf_result_path_ssp245)
rf_raster_ssp370 <- raster(rf_result_path_ssp370)
rf_raster_ssp585 <- raster(rf_result_path_ssp585)
cat("RF raster loaded: ", rf_result_path_historical, "\n")
startTime <- Sys.time()
diff_raster_historical <- maxent_raster_historical - rf_raster_historical
endTime <- Sys.time()
cat("Difference raster calculated time: ", "\n")
print(endTime-startTime)
diff_raster_ssp126 <- maxent_raster_ssp126 - rf_raster_ssp126
diff_raster_ssp245 <- maxent_raster_ssp245 - rf_raster_ssp245
diff_raster_ssp370 <- maxent_raster_ssp370 - rf_raster_ssp370
diff_raster_ssp585 <- maxent_raster_ssp585 - rf_raster_ssp585
cat("Difference raster calculated: ", "\n")
writeRaster(diff_raster_historical, paste(top_diff_file_dir,'/',this_bug,'/diff_historical.tif',sep = ''), format="GTiff", overwrite=TRUE)
writeRaster(diff_raster_ssp126, paste(top_diff_file_dir,'/',this_bug,'/diff_ssp126.tif',sep = ''), format="GTiff", overwrite=TRUE)
writeRaster(diff_raster_ssp245, paste(top_diff_file_dir,'/',this_bug,'/diff_ssp245.tif',sep = ''), format="GTiff", overwrite=TRUE)
writeRaster(diff_raster_ssp370, paste(top_diff_file_dir,'/',this_bug,'/diff_ssp370.tif',sep = ''), format="GTiff", overwrite=TRUE)
writeRaster(diff_raster_ssp585, paste(top_diff_file_dir,'/',this_bug,'/diff_ssp585.tif',sep = ''), format="GTiff", overwrite=TRUE)
cat("Difference raster saved: ", "\n")
startTime <- Sys.time()
sum_maxent_raster_historical <- cellStats(maxent_raster_historical, sum)
endTime <- Sys.time()
cat("Sum raster calculated time: ", "\n")
print(endTime-startTime)
sum_rf_raster_historical <- cellStats(rf_raster_historical, sum)
sum_diff_raster_historical <- cellStats(diff_raster_historical, sum)
cat("Sum calculated: ", "\n")
sum_maxent_raster_ssp126 <- cellStats(maxent_raster_ssp126, sum)
sum_rf_raster_ssp126 <- cellStats(rf_raster_ssp126, sum)
sum_diff_raster_ssp126 <- cellStats(diff_raster_ssp126, sum)
sum_maxent_raster_ssp245 <- cellStats(maxent_raster_ssp245, sum)
sum_rf_raster_ssp245 <- cellStats(rf_raster_ssp245, sum)
sum_diff_raster_ssp245 <- cellStats(diff_raster_ssp245, sum)
sum_maxent_raster_ssp370 <- cellStats(maxent_raster_ssp370, sum)
sum_rf_raster_ssp370 <- cellStats(rf_raster_ssp370, sum)
sum_diff_raster_ssp370 <- cellStats(diff_raster_ssp370, sum)
sum_maxent_raster_ssp585 <- cellStats(maxent_raster_ssp585, sum)
sum_rf_raster_ssp585 <- cellStats(rf_raster_ssp585, sum)
sum_diff_raster_ssp585 <- cellStats(diff_raster_ssp585, sum)
all_sum_results <- list("sum_maxent_raster_historical" = sum_maxent_raster_historical,
"sum_rf_raster_historical" = sum_rf_raster_historical,
"sum_diff_raster_historical" = sum_diff_raster_historical,
"sum_maxent_raster_ssp126" = sum_maxent_raster_ssp126,
"sum_rf_raster_ssp126" = sum_rf_raster_ssp126,
"sum_diff_raster_ssp126" = sum_diff_raster_ssp126,
"sum_maxent_raster_ssp245" = sum_maxent_raster_ssp245,
"sum_rf_raster_ssp245" = sum_rf_raster_ssp245,
"sum_diff_raster_ssp245" = sum_diff_raster_ssp245,
"sum_maxent_raster_ssp370" = sum_maxent_raster_ssp370,
"sum_rf_raster_ssp370" = sum_rf_raster_ssp370,
"sum_diff_raster_ssp370" = sum_diff_raster_ssp370,
"sum_maxent_raster_ssp585" = sum_maxent_raster_ssp585,
"sum_rf_raster_ssp585" = sum_rf_raster_ssp585,
"sum_diff_raster_ssp585" = sum_diff_raster_ssp585)
saveRDS(all_sum_results, paste(top_diff_file_dir,'/',this_bug,'/sum_results.rds',sep = ''))
csv_saving_path_sum <- paste(top_diff_file_dir,'/',this_bug,'/sum_results.csv',sep = '')
write.csv(all_sum_results, file = csv_saving_path_sum)
cat("Sum results saved: ", csv_saving_path_sum, "\n")
}
library("raster")
bug_list <- list("San","Ger","Rec","Dim","Ind","Lec","Lon","Maz","Mex","Neo","Pro","Rub")
top_maxent_file_dir <- "/Users/liting/Documents/GitHub/r_chagasM/output/pixel_buffer_off"
top_rf_file_dir <- "/Users/liting/Documents/GitHub/r_chagasM/output/rf/pixel_buffer_off"
top_diff_file_dir <- "/Users/liting/Documents/GitHub/r_chagasM/output/figures/final_plot/difference"
for (this_bug in bug_list){
top_file_dir <- paste(top_diff_file_dir,'/',this_bug,sep = '')
print(top_file_dir)
if (!dir.exists(top_file_dir)){
dir.create(top_file_dir)
}else{
print("dir exists")
}
cat("Processing bug: ", this_bug, "\n")
cat("Maxent file path: ", top_maxent_file_dir, "\n")
maxent_result_path_historical <- paste(top_maxent_file_dir,'/',this_bug,'/result/output_raster/all_input/historical_predict_allinput_',this_bug,'.tif',sep = '')
maxent_result_path_ssp126 <- paste(top_maxent_file_dir,'/',this_bug,'/result/output_raster/all_input/ssp126_predict_allinput_',this_bug,'.tif',sep = '')
maxent_result_path_ssp245 <- paste(top_maxent_file_dir,'/',this_bug,'/result/output_raster/all_input/ssp245_predict_allinput_',this_bug,'.tif',sep = '')
maxent_result_path_ssp370 <- paste(top_maxent_file_dir,'/',this_bug,'/result/output_raster/all_input/ssp370_predict_allinput_',this_bug,'.tif',sep = '')
maxent_result_path_ssp585 <- paste(top_maxent_file_dir,'/',this_bug,'/result/output_raster/all_input/ssp585_predict_allinput_',this_bug,'.tif',sep = '')
cat("Maxent result path: ", maxent_result_path_historical, "\n")
rf_result_path_historical <- paste(top_rf_file_dir,'/',this_bug,'/result/output_raster/all_input/historical_predict_allinput_',this_bug,'.tif',sep = '')
rf_result_path_ssp126 <- paste(top_rf_file_dir,'/',this_bug,'/result/output_raster/all_input/ssp126_predict_allinput_',this_bug,'.tif',sep = '')
rf_result_path_ssp245 <- paste(top_rf_file_dir,'/',this_bug,'/result/output_raster/all_input/ssp245_predict_allinput_',this_bug,'.tif',sep = '')
rf_result_path_ssp370 <- paste(top_rf_file_dir,'/',this_bug,'/result/output_raster/all_input/ssp370_predict_allinput_',this_bug,'.tif',sep = '')
rf_result_path_ssp585 <- paste(top_rf_file_dir,'/',this_bug,'/result/output_raster/all_input/ssp585_predict_allinput_',this_bug,'.tif',sep = '')
cat("RF result path: ", rf_result_path_historical, "\n")
maxent_raster_historical <- raster(maxent_result_path_historical)
maxent_raster_ssp126 <- raster(maxent_result_path_ssp126)
maxent_raster_ssp245 <- raster(maxent_result_path_ssp245)
maxent_raster_ssp370 <- raster(maxent_result_path_ssp370)
maxent_raster_ssp585 <- raster(maxent_result_path_ssp585)
cat("Maxent raster loaded: ", maxent_result_path_historical, "\n")
rf_raster_historical <- raster(rf_result_path_historical)
rf_raster_ssp126 <- raster(rf_result_path_ssp126)
rf_raster_ssp245 <- raster(rf_result_path_ssp245)
rf_raster_ssp370 <- raster(rf_result_path_ssp370)
rf_raster_ssp585 <- raster(rf_result_path_ssp585)
cat("RF raster loaded: ", rf_result_path_historical, "\n")
startTime <- Sys.time()
diff_raster_historical <- - maxent_raster_historical + rf_raster_historical
endTime <- Sys.time()
cat("Difference raster calculated time: ", "\n")
print(endTime-startTime)
diff_raster_ssp126 <- - maxent_raster_ssp126 + rf_raster_ssp126
diff_raster_ssp245 <- - maxent_raster_ssp245 + rf_raster_ssp245
diff_raster_ssp370 <- - maxent_raster_ssp370 + rf_raster_ssp370
diff_raster_ssp585 <- - maxent_raster_ssp585 + rf_raster_ssp585
cat("Difference raster calculated: ", "\n")
writeRaster(diff_raster_historical, paste(top_diff_file_dir,'/',this_bug,'/diff_historical.tif',sep = ''), format="GTiff", overwrite=TRUE)
writeRaster(diff_raster_ssp126, paste(top_diff_file_dir,'/',this_bug,'/diff_ssp126.tif',sep = ''), format="GTiff", overwrite=TRUE)
writeRaster(diff_raster_ssp245, paste(top_diff_file_dir,'/',this_bug,'/diff_ssp245.tif',sep = ''), format="GTiff", overwrite=TRUE)
writeRaster(diff_raster_ssp370, paste(top_diff_file_dir,'/',this_bug,'/diff_ssp370.tif',sep = ''), format="GTiff", overwrite=TRUE)
writeRaster(diff_raster_ssp585, paste(top_diff_file_dir,'/',this_bug,'/diff_ssp585.tif',sep = ''), format="GTiff", overwrite=TRUE)
cat("Difference raster saved: ", "\n")
startTime <- Sys.time()
sum_maxent_raster_historical <- cellStats(maxent_raster_historical, sum)
endTime <- Sys.time()
cat("Sum raster calculated time: ", "\n")
print(endTime-startTime)
sum_rf_raster_historical <- cellStats(rf_raster_historical, sum)
sum_diff_raster_historical <- cellStats(diff_raster_historical, sum)
cat("Sum calculated: ", "\n")
sum_maxent_raster_ssp126 <- cellStats(maxent_raster_ssp126, sum)
sum_rf_raster_ssp126 <- cellStats(rf_raster_ssp126, sum)
sum_diff_raster_ssp126 <- cellStats(diff_raster_ssp126, sum)
sum_maxent_raster_ssp245 <- cellStats(maxent_raster_ssp245, sum)
sum_rf_raster_ssp245 <- cellStats(rf_raster_ssp245, sum)
sum_diff_raster_ssp245 <- cellStats(diff_raster_ssp245, sum)
sum_maxent_raster_ssp370 <- cellStats(maxent_raster_ssp370, sum)
sum_rf_raster_ssp370 <- cellStats(rf_raster_ssp370, sum)
sum_diff_raster_ssp370 <- cellStats(diff_raster_ssp370, sum)
sum_maxent_raster_ssp585 <- cellStats(maxent_raster_ssp585, sum)
sum_rf_raster_ssp585 <- cellStats(rf_raster_ssp585, sum)
sum_diff_raster_ssp585 <- cellStats(diff_raster_ssp585, sum)
all_sum_results <- list("sum_maxent_raster_historical" = sum_maxent_raster_historical,
"sum_rf_raster_historical" = sum_rf_raster_historical,
"sum_diff_raster_historical" = sum_diff_raster_historical,
"sum_maxent_raster_ssp126" = sum_maxent_raster_ssp126,
"sum_rf_raster_ssp126" = sum_rf_raster_ssp126,
"sum_diff_raster_ssp126" = sum_diff_raster_ssp126,
"sum_maxent_raster_ssp245" = sum_maxent_raster_ssp245,
"sum_rf_raster_ssp245" = sum_rf_raster_ssp245,
"sum_diff_raster_ssp245" = sum_diff_raster_ssp245,
"sum_maxent_raster_ssp370" = sum_maxent_raster_ssp370,
"sum_rf_raster_ssp370" = sum_rf_raster_ssp370,
"sum_diff_raster_ssp370" = sum_diff_raster_ssp370,
"sum_maxent_raster_ssp585" = sum_maxent_raster_ssp585,
"sum_rf_raster_ssp585" = sum_rf_raster_ssp585,
"sum_diff_raster_ssp585" = sum_diff_raster_ssp585)
saveRDS(all_sum_results, paste(top_diff_file_dir,'/',this_bug,'/sum_results.rds',sep = ''))
csv_saving_path_sum <- paste(top_diff_file_dir,'/',this_bug,'/sum_results.csv',sep = '')
write.csv(all_sum_results, file = csv_saving_path_sum)
cat("Sum results saved: ", csv_saving_path_sum, "\n")
}
